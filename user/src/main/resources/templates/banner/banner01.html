<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/style.css" />

  <title>전체 배너 목록</title>
  <style>
    body {
      font-family: 'Pretendard', sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    h4 {
      font-size: 24px;
      margin-bottom: 20px;
    }
    .data-grid {
      width: 100%;
      border-collapse: collapse;
    }
    .data-grid th {
      background-color: #f5f5f5;
      padding: 12px;
      text-align: left;
      font-weight: bold;
      border-bottom: 1px solid #ddd;
    }
    .data-grid td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
    }
    .data-grid tr:hover {
      background-color: #f9f9f9;
      cursor: pointer;
    }
    .checkbox-header {
      width: 30px;
    }
    .checkbox-cell {
      text-align: center;
    }
  </style>
</head>
<body>
    <main layout:fragment="content">
        <div class="admin-container">
            <!-- 사이드바 -->
            <div class="sidebar">
                <h2>챗짱 Admin</h2>
                <a href="/campaign/list"><div class="menu-item active">캠페인 목록 요약</div></a>
                <div class="menu-item">전체 캠페인 목록</div>
                <div class="menu-item">선정인원 없는 캠페인 목록</div>
                <div class="menu-item">캠페인 등록</div>
                <div class="menu-item">알림톡</div>
                <a href="/banner/banner01"><div class="menu-item">배너</div></a>
                <div class="menu-item">공지사항</div>
                <div class="menu-item">이용가이드</div>
                <a href="/user/user01"><div class="menu-item">유저</div></a>
            </div>

            <!-- 본문 영역 -->
            <div class="main-content">
                
                <h1><a href="/banner/banner01">전체 배너 목록</a></h1>
                <form class="optionForm" action="/banner/banner01" method="get" id="form">
                    <select name="code">
                        <option value="0" th:selected="${option.code==0}">전체</option>
                        <option value="1" th:selected="${option.code==1}">배너명</option>
                        <option value="2" th:selected="${option.code==2}">url</option>
                        <option value="3" th:selected="${option.code==3}">화면여부</option>
                    </select>
                    <select name="orderCode" id="order-code">
                        <option value="0" th:selected="${option.orderCode == 0}">최신순</option>
                        <option value="1" th:selected="${option.orderCode == 1}">제목순</option>
                    </select>
                    <input type="text" name="keyword" placeholder="검색어를 입력해 주세요." th:value="${param.keyword}">
                    <input class="optionSubmit" type="submit" value="검색">
                </form>
            <table class="data-grid">
                <thead>
                    <tr>
                    <!-- <th class="checkbox-header">
                        <input type="checkbox" id="select-all">
                    </th> -->
                        <th style="width: 30px;">ID</th>
                        <th style="width: 200px;">배너명</th>
                        <th style="width: 300px;">배너 URL</th>
                        <th style="width: 30px;">화면 여부</th>
                    </tr>
                </thead>
                <tbody id="banner-list">
                    <!-- 여기에 데이터가 동적으로 들어갈 예정 -->
                    <th:block th:if="${bannerList.isEmpty()}">
                        <tr>
                            <td colspan="4" align="center">조회된 데이터가 없습니다.</td>
                        </tr>
                    </th:block>
                    <th:block th:each="banner : ${bannerList}">
                        <!-- <tr th:onclick="|location.href='@{/banner/banner02(id=${banner.bannerId}),targetType=banner}'|"> -->
                        <tr th:onclick="|location.href='@{/banner/banner02(id=${banner.bannerId}, targetType='banner')}'|">

                            <td><span th:text="${banner.bannerId}"></span></td>
                            <td><span th:text="${banner.title}"></span></td>
                            <td><span th:text="${banner.url}"></span></td>
                            <td><span th:text="${banner.isDeleted == 'N' ? '화면' : '비화면'}"></span></td>
                        </tr>
                    </th:block>
                </tbody>
            </table>
            <div class="parent">
                <div class="child">
                <!-- [처음] -->
                <!-- <a th:href="|/board/list?page=${page.first}&keyword=${option.keyword}&code=${option.code}&rows=${page.rows}&orderCode=${option.orderCode}|">[처음]</a> -->
                <!-- <a th:href="@{/board/list(page=${page.first}, keyword=${ option.keyword}, code=${option.code}, rows=${page.rows}, orderCode=${option.orderCode})}">[처음]</a> -->
                <a th:href="@{${pageUrl} + '&page=' + ${page.first}}">[처음]</a>
                <!-- [이전] -->
                <th:block th:if="${page.page != page.first }">
                    <!-- <a th:href="|/board/list?page=${page.prev}&keyword=${option.keyword}&code=${option.code}&rows=${page.rows}&orderCode=${option.orderCode}|">[이전]</a> -->
                    <!-- <a th:href="@{/board/list(page=${page.prev}, keyword=${option.keyword}, code=${option.code}, rows=${page.rows}, orderCode=${option.orderCode})}">[이전]</a> -->
                    <a th:href="@{${pageUrl} + '&page=' + ${page.prev}}">[이전]</a>
                </th:block>

                <!-- [페이지 번호] -->
                <!-- 
                    #numbers.sequence( 시작, 끝 )
                    : 시작번호부터 끝 번호까지 리스트를 생성
                -->
                
                <th:block th:each="no : ${#numbers.sequence(page.start, page.end)}">
                    <!-- 현재 페이지 -->
                    <th:block th:if="${page.page == no}">
                        <b><span th:text="${no}"></span></b>
                    </th:block>
                    <th:block th:if="${page.page != no}">
                        <!-- 기본 URL -->
                        <!-- <a th:href="|/board/list?page=${no}&keyword=${option.keyword}&code=${option.code}&rows=${page.rows}&orderCode=${option.orderCode}|" th:text="${no}"></a> -->
                        <!-- 타임리프 URL 표현식 -->
                        <!-- <a th:href="@{/board/list(page=${no}, keyword=${option.keyword}, code=${option.code}, rows=${page.rows}, orderCode=${option.orderCode})}" th:text="${no}">/a> -->
                        <a th:href="@{${pageUrl} + '&page='+${no}}" th:text="${no}"></a>
                    </th:block>
                </th:block>
                <!-- [다음] -->
                <th:block th:if="${page.page != page.last }">
                    <!-- <a th:href="|/board/list?page=${page.next}&keyword=${option.keyword}&code=${option.code}&rows=${page.rows}&orderCode=${option.orderCode}|">[다음]</a> -->
                    <!-- <a th:href="@{/board/list(page=${page.next}, keyword=${option.keyword}, code=${option.code}, rows=${page.rows}, orderCode=${option.orderCode})}">[다음]</a> -->
                    <a th:href="@{${pageUrl} + '&page=' + ${page.next}}">[다음]</a>
                </th:block>
                <!-- [마지막] -->
                <!-- <a th:href="|/board/list?page=${page.last}&keyword=${option.keyword}&code=${option.code}&rows=${page.rows}&orderCode=${option.orderCode}|">[마지막]</a> -->
                <!-- <a th:href="@{/board/list(page=${page.last}, keyword=${option.keyword}, code=${option.code}, rows=${page.rows}, orderCode=${option.orderCode})}">[마지막]</a> -->
                <a th:href="@{${pageUrl} + '&page=' + ${page.last}}">[마지막]</a>
            </div>
            
            </div>
            <a href="/banner/banner03" class="insert">등록</a>
        </div>
    </div>

        <script>
        // 배너 데이터를 가져와서 테이블에 표시하는 함수
        async function getBannerList() {
        try {
            // API 호출 (실제로는 fetch나 axios 등으로 구현)
            const response = await fetch('/api/banners');
            const data = await response.json();
            
            const bannerList = document.getElementById('banner-list');
            bannerList.innerHTML = ''; // 기존 내용 초기화
            
            // 데이터 행 생성
            // data.list.forEach(banner => {
            //   const row = document.createElement('tr');
            //   row.innerHTML = `
            //     <td class="checkbox-cell"><input type="checkbox" data-id="${banner.id}"></td>
            //     <td>${banner.id}</td>
            //     <td>${banner.name}</td>
            //     <td>${banner.url}</td>
            //   `;
            
            //   // 행 클릭 이벤트
            //   row.addEventListener('click', () => {
            //     window.location.href = `/admin/banner/edit/${banner.id}`;
            //   });
            
            //   bannerList.appendChild(row);
            // });
        } catch (error) {
            console.error('배너 목록을 가져오는 중 오류가 발생했습니다:', error);
        }
        }

        // 전체 선택 체크박스 이벤트
        document.getElementById('select-all').addEventListener('change', function() {
        const checkboxes = document.querySelectorAll('#banner-list input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = this.checked;
        });
        });

        // 페이지 로드 시 배너 목록 가져오기
        document.addEventListener('DOMContentLoaded', getBannerList);
    </script>
    </main>
</body>
</html>