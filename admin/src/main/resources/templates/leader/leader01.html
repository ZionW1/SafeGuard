<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <th:block th:replace="~{fragments/csrfFragments :: metaCsrf}"></th:block>
    <title>Document</title>
    <link rel="stylesheet" href="/css/style.css" />
    
    <style>
        .ck-editor__editable_inline {
            min-height: 400px;
        }

        .ck-content .image img {
            display: block;
            margin: 0 auto;
            max-width: 100%;
            min-width: unset !important; /* ğŸ”¥ ì´ê±¸ ì¶”ê°€í•´ì¤˜! */
            height: auto !important; /* ì¶”ê°€ì ìœ¼ë¡œ heightë„ autoë¡œ ê³ ì •ë  ìˆ˜ ìˆìœ¼ë‹ˆ unset */
        }
        /* â­ï¸â­ï¸â­ï¸ ì´ë¯¸ì§€ ìº¡ì…˜ ìŠ¤íƒ€ì¼ ìˆ˜ì • â­ï¸â­ï¸â­ï¸ */
        .ck-content .image-style-side {
            float: left;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }

        .ck-content .image-style-alignLeft {
            float: left;
            margin-right: 1em;
        }

        .ck-content .image-style-alignRight {
            float: right;
            margin-left: 1em;
        }

        .ck-content .image-style-alignCenter {
            margin-left: auto;
            margin-right: auto;
            display: block;
        }
        /* .ck-content .image img {
            display: block;
            margin: 0 auto;
            max-width: 100%;
        } */
        .ck-content figure.image figcaption {
            caption-side: top; /* ìº¡ì…˜ì„ ì´ë¯¸ì§€ ìœ„ì— ë°°ì¹˜ */
            text-align: center; /* ê°€ìš´ë° ì •ë ¬ */
            margin-bottom: 0.5em;
            font-style: italic;
            color: #555;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <div th:replace="~{fragments/sidebar :: sidebarFragment}"></div>

        <!-- ë³¸ë¬¸ ì˜ì—­ -->
        <div class="main-content">
            <form th:action="@{/admin/leader02}" id="contentForm" method="post">
                <th:block th:replace="fragments/csrfFragments :: inputCsrf"></th:block>

                <div th:if="${leaderSelect == null}">
                    <h1><a href="/admin/leader01">ì¸ì†”ì ìƒì„±</a></h1>
                    <input type="hidden" id="action" name="action" th:value="I"/>
                    <label for="title">ì¸ì†”ì ì œëª©</label>
                    <input type="text" id="title" name="title"/>
                    <div style="height: 10px;"></div>
                    <label for="content">ì¸ì†”ì ë‚´ìš©</label>
                    <textarea id="content" name="content" rows="10" cols="60" style="width: 900px;"></textarea>
                </div>
                <div th:if="${leaderSelect != null}">
                    <h1><a href="/admin/leader01">ì¸ì†”ì ìˆ˜ì •</a></h1>
                    <label for="content">ì¸ì†”ì ìƒì„±/ìˆ˜ì •</label>
                    <input type="hidden" id="adminContentId" name="adminContentId" th:value="${leaderSelect.adminContentId}"/>
                    <input type="hidden" id="action" name="action" th:value="U"/>
                    <label for="title">ì¸ì†”ì ì œëª©</label><br/>
                    <input type="text" id="title" name="title" th:value="${leaderSelect.title}"/>
                    <div style="height: 10px;"></div>
                    <label for="content">ì¸ì†”ì ë‚´ìš©</label>
                    <textarea id="content" name="content" rows="10" cols="60" style="width: 900px;" th:text="${leaderSelect.content}"></textarea>
                </div>
                <button style="margin-top: 10px;" type="submit">ì €ì¥í•˜ê¸°</button>
            </form>
        </div>
        
    </div>
    
    
    <!-- <script src="https://cdn.ckeditor.com/ckeditor5/39.0.1/classic/ckeditor.js"></script> -->
    <!-- <script src="https://cdn.ckeditor.com/ckeditor5/40.1.0/classic/ckeditor.js"></script> -->
    <script src="/js/ckeditor.js"></script> 

<!-- â­ï¸â­ï¸â­ï¸ ì´ ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ ì•ˆì—ì„œ CKEditor ì´ˆê¸°í™” â­ï¸â­ï¸â­ï¸ -->
<script>
    // 1. MyCustomUploadAdapterPluginì„ ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜ (or ì´ ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ ì•ˆì— ì •ì˜)
    // ì´ ì½”ë“œë¥¼ ë„ˆì˜ <script> íƒœê·¸ ì•ˆì— ì§ì ‘ ë„£ëŠ” ê²ƒì´ ê°€ì¥ ê°„ë‹¨í•´.
    function MyCustomUploadAdapterPlugin(editor) {
        editor.plugins.get('FileRepository').createUploadAdapter = (loader) => {
            return new MyUploadAdapter(loader);
        };
    }

    class MyUploadAdapter {
        constructor(loader) {
            this.loader = loader;
        }
        upload() {
            return this.loader.file
                .then(file => new Promise((resolve, reject) => {
                    const data = new FormData();
                    data.append('upload', file);

                    fetch('/upload/image', { method: 'POST', body: data })
                        .then(response => response.json())
                        .then(result => {
                            if (result.uploaded && result.url) {
                                resolve({ default: result.url });
                            } else {
                                reject(result.error && result.error.message ? result.error.message : 'ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨.');
                            }
                        })
                        .catch(err => reject('íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ' + err));
                }));
        }
        abort() { /* ì—…ë¡œë“œ ì·¨ì†Œ ë¡œì§ (í•„ìš”ì‹œ) */ }
    }

    // 2. window.ClassicEditor ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ë””í„° ìƒì„±
    let editorInstance; // ì—ë””í„° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥í•  ë³€ìˆ˜

    ClassicEditor
        // â­ï¸â­ï¸â­ï¸ ì—¬ê¸°ê°€ ì‹¤ì œ ì—ë””í„°ë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ì´ì•¼. â­ï¸â­ï¸â­ï¸
        // HTMLì˜ <textarea id="editor">ì— ì—°ê²°ë˜ë„ë¡ selectorë¥¼ '#editor'ë¡œ ë³€ê²½í–ˆì–´.
        .create(document.querySelector('#content'), {
            // MyCustomUploadAdapterPluginì€ ìš°ë¦¬ê°€ src/ckeditor.jsì˜ builtinPluginsì— ì¶”ê°€í–ˆê¸° ë•Œë¬¸ì—,
            // ì—¬ê¸°ì„œ extraPluginsë¡œ ë‹¤ì‹œ ëª…ì‹œí•  í•„ìš”ëŠ” ì—†ì–´! ë¹Œë“œì— ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆì„ ê±°ì•¼.
            licenseKey: 'GPL',  // â­ï¸â­ï¸â­ï¸ ì—¬ê¸°ì— ì§ì ‘ ì¶”ê°€í•´ì„œ ë‹¤ì‹œ ì‹œë„í•´ ë´ â­ï¸â­ï¸â­ï¸
            toolbar: {
                items: [
                    'heading', '|', 'bold', 'italic', '|',
                    'fontSize', // â­ï¸ ê¸€ì”¨ í¬ê¸° ì¡°ì ˆ ë²„íŠ¼
                    'fontColor', // â­ï¸ ê¸€ì”¨ ìƒ‰ìƒ ì¡°ì ˆ ë²„íŠ¼
                    'fontBackgroundColor', // â­ï¸ ê¸€ì”¨ ë°°ê²½ ìƒ‰ìƒ ì¡°ì ˆ ë²„íŠ¼
                    '|',
                    'link', 'bulletedList', 'numberedList', '|',
                    'indent', 'outdent', '|',
                    'imageUpload', 'blockQuote', 'insertTable', 'mediaEmbed', 'undo', 'redo'
                ]
            },
            // â­ï¸ ì´ë¯¸ì§€ ì„¤ì • â­ï¸
            image: {
                toolbar: [
                    'imageTextAlternative', 'toggleImageCaption',
                    'imageStyle:inline', 'imageStyle:block', 'imageStyle:side',
                    '|', // êµ¬ë¶„ì„  (ì„ íƒ ì‚¬í•­)
                    'resizeImage', // ì´ë¯¸ì§€ í´ë¦­ ì‹œ ë“œë˜ê·¸ í•¸ë“¤ì´ ë‚˜ì˜¤ë„ë¡ í•˜ëŠ” ê¸°ë³¸ ì•„ì´í…œ
                    'resizeImage:50', 'resizeImage:75', 'resizeImage:original' // íŠ¹ì • ë¹„ìœ¨ë¡œ ì¡°ì ˆí•˜ëŠ” ë²„íŠ¼
                ],
                resizeOptions: [
                    // â­ï¸â­ï¸â­ï¸ ì—¬ê¸°ë¥¼ ìˆ˜ì •í•´ ì¤˜! â­ï¸â­ï¸â­ï¸
                    // icon ì´ë¦„ì„ CKEditorê°€ ì•„ëŠ” ëª…ì‹œì ì¸ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ê±°ë‚˜, ì•„ì˜ˆ ì œê±°í•´ì„œ í”ŒëŸ¬ê·¸ì¸ ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•˜ê²Œ í•´ì•¼ í•´.
                    // ImageResizeButtons í”ŒëŸ¬ê·¸ì¸ì€ ìì²´ì ìœ¼ë¡œ 'small', 'medium', 'large', 'original' ì•„ì´ì½˜ì„ ì¸ì‹í•´.
                    { name: 'resizeImage:original', value: null, icon: 'original' }, // 'originalSize' -> 'original'
                    { name: 'resizeImage:25', value: '25%', icon: 'small' },           // 'medium' -> 'small' (ìƒˆë¡œ ì¶”ê°€)
                    { name: 'resizeImage:50', value: '50%', icon: 'medium' },           // 'medium'
                    { name: 'resizeImage:75', value: '75%', icon: 'large' }             // 'large'
                ],
                // resizeUnit: 'px', // ê¸°ë³¸ì ìœ¼ë¡œ í”½ì…€ ì¡°ì ˆ ê°€ëŠ¥
                styles: [
                    'full', 'side', 'alignLeft', 'alignCenter', 'alignRight'
                ]
            },
            // // â­ï¸ íŒŒì¼ ì—…ë¡œë“œ ì„¤ì • â­ï¸
            // ckfinder: {
            //     uploadUrl: '/upload/image' // ìš°ë¦¬ì˜ ì»¤ìŠ¤í…€ ì—…ë¡œë“œ ì–´ëŒ‘í„° URL
            // },
            // â­ï¸ í•œêµ­ì–´ ì„¤ì • (ìš°ë¦¬ê°€ ë¹Œë“œ ì‹œ language: 'ko'ë¡œ ì„¤ì •í–ˆìœ¼ë‹ˆ ì•„ë§ˆ í•„ìš” ì—†ì„ ê±°ì•¼. í™•ì¸ìš©.) â­ï¸
            language: 'ko', 
            table: {
                contentToolbar: [
                    'tableColumn',
                    'tableRow',
                    'mergeTableCells',
                    'splitTableCell', // â­ï¸ ì¶”ê°€: ì…€ ë¶„ë¦¬ ê¸°ëŠ¥
                    'toggleTableCaption', // â­ï¸ ì¶”ê°€: í‘œ ìº¡ì…˜(ì œëª©) í† ê¸€ ê¸°ëŠ¥
                    '|', // êµ¬ë¶„ì„  (í•„ìš”í•˜ë©´ ë„£ì–´ì¤˜)
                    'tableProperties', // â­ï¸ ì¶”ê°€: í‘œ ì „ì²´ ì†ì„± í¸ì§‘ ëª¨ë‹¬
                    'tableCellProperties' // â­ï¸ ì¶”ê°€: ì„ íƒëœ ì…€ ì†ì„± í¸ì§‘ ëª¨ë‹¬
            ] // í‘œ í¸ì§‘ íˆ´ë°” ì˜µì…˜
                
            },

            fontSize: {
            options: [
                10, 12, 14, 'default', 18, 20, 22, 24, 26, 28, 30 // px ë‹¨ìœ„ë¡œ ì„¤ì •
            ],
            supportAllValues: true // ì´ ì„¤ì •ì„ í•˜ë©´, ëª©ë¡ì— ì—†ëŠ” ê°’ë„ ìˆ˜ë™ ì…ë ¥ ê°€ëŠ¥í•˜ê²Œ ë¼ (ë¸Œë¼ìš°ì € ì§€ì› ì‹œ)
        },
        // â­ï¸ ê¸€ì”¨ ìƒ‰ìƒ ë° ë°°ê²½ ìƒ‰ìƒ ì˜µì…˜ ì¶”ê°€ (ì›í•˜ëŠ” ìƒ‰ìƒìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥) â­ï¸
        fontColor: {
                colors: [
                    { color: 'hsl(0, 0%, 0%)', label: 'Black' },
                    { color: 'hsl(0, 0%, 30%)', label: 'Dim grey' },
                    { color: 'hsl(0, 0%, 60%)', label: 'Grey' },
                    { color: 'hsl(0, 0%, 90%)', label: 'Light grey' },
                    { color: 'hsl(0, 0%, 100%)', label: 'White', 
                    // 'hasBorder'ëŠ” ìƒ‰ìƒì´ ë„ˆë¬´ ë°ì•„ì„œ í…Œë‘ë¦¬ë¡œ êµ¬ë¶„í•´ì•¼ í•  ë•Œ ì‚¬ìš©
                    hasBorder: true
                    },
                    { color: 'hsl(0, 75%, 60%)', label: 'Red' },
                    { color: 'hsl(30, 75%, 60%)', label: 'Orange' },
                    { color: 'hsl(60, 75%, 60%)', label: 'Yellow' },
                    { color: 'hsl(90, 75%, 60%)', label: 'Light green' },
                    { color: 'hsl(120, 75%, 60%)', label: 'Green' },
                    { color: 'hsl(180, 75%, 60%)', label: 'Cyan' },
                    { color: 'hsl(210, 75%, 60%)', label: 'Light blue' },
                    { color: 'hsl(240, 75%, 60%)', label: 'Blue' },
                    { color: 'hsl(270, 75%, 60%)', label: 'Purple' }
                ]
            },
            fontBackgroundColor: {
                colors: [
                    { color: 'hsl(0, 0%, 0%)', label: 'Black' },
                    { color: 'hsl(0, 0%, 30%)', label: 'Dim grey' },
                    { color: 'hsl(0, 0%, 60%)', label: 'Grey' },
                    { color: 'hsl(0, 0%, 90%)', label: 'Light grey' },
                    { color: 'hsl(0, 0%, 100%)', label: 'White', hasBorder: true },
                    { color: 'hsl(0, 75%, 60%)', label: 'Red' },
                    { color: 'hsl(30, 75%, 60%)', label: 'Orange' },
                    { color: 'hsl(60, 75%, 60%)', label: 'Yellow' },
                    { color: 'hsl(90, 75%, 60%)', label: 'Light green' },
                    { color: 'hsl(120, 75%, 60%)', label: 'Green' },
                    { color: 'hsl(180, 75%, 60%)', label: 'Cyan' },
                    { color: 'hsl(210, 75%, 60%)', label: 'Light blue' },
                    { color: 'hsl(240, 75%, 60%)', label: 'Blue' },
                    { color: 'hsl(270, 75%, 60%)', label: 'Purple' }
                ]
            },
            // â­ï¸ ê¸°íƒ€ íˆ´ë°” ì•„ì´í…œ ì„¤ì • â­ï¸
            // ë§Œì•½ íˆ´ë°” êµ¬ì„±ì„ ëª…ì‹œí•˜ê³  ì‹¶ë‹¤ë©´ ì—¬ê¸°ì— ì¶”ê°€í•˜ë©´ ë¼.
            // toolbar: {
            //     items: [
            //         'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', '|',
            //         'blockQuote', 'imageUpload', 'insertTable', 'mediaEmbed', 'undo', 'redo'
            //     ]
            // }

        })
        .then(editor => {
            editorInstance = editor; // ì—ë””í„° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥
            console.log('CKEditorê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', editor);
            // ì—ë””í„° ë¡œë”© í›„ì— í•„ìš”í•œ ì¶”ê°€ì ì¸ ì´ˆê¸°í™” ì‘ì—…ì„ ì—¬ê¸°ì— ë„£ì„ ìˆ˜ ìˆì–´.
        })
        .catch(error => {
            console.log("aaa");
            console.log('ì—ëŸ¬ ë°œìƒí–ˆì–´ìš” : '+error);
            // console.error('CKEditor ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
        });

    // í¼ ì œì¶œ ì‹œ ì—ë””í„° ë‚´ìš©ì„ textareaì— ë°˜ì˜
    document.getElementById('contentForm').addEventListener('ss', function(event) {
        // CKEditor 5ëŠ” ìƒì„±ë  ë•Œ ì—°ê²°ëœ <textarea>ì˜ ë‚´ìš©ì„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•´ì¤˜.
        // ê·¸ë˜ì„œ ë³´í†µ ì´ `submit` ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì•ˆì—ì„œ `getData()`ë¥¼ í˜¸ì¶œí•˜ê³  
        // hidden inputì— ë„£ëŠ” ë“±ì˜ ì‘ì—…ì´ í•„ìš” ì—†ëŠ” ê²½ìš°ê°€ ë§ì•„.
        // formì˜ `textarea` name="content"ë¡œ ê°’ì´ ì˜ ë„˜ì–´ê°ˆ ê±°ì•¼.
        console.log("í¼ì´ ì œì¶œë©ë‹ˆë‹¤. CKEditor ë‚´ìš©:", editorInstance.getData());
    });
</script>
</body>
</html>